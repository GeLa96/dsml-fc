```{r}
library(readr)
library(readr)
library(RSelenium)
library(netstat)
library(tidyverse)
library(tidyverse)
library(lubridate)
library(zoo)
library(data.table)
library(binman)
library(wdman)
#date to selects
startDate <- "09/02/2024"
endDate <- "11/02/2025"
#Category to select
category <- "#category_employment"
#date to selects
startDate <- "09/02/2024"
endDate <- "11/02/2025"
#Category to select
category <- "#category_employment"
```{r}
#    browser = "firefox",
#    extraCapabilities = eCaps,
#    chromever = NULL,
#    geckover = "latest",
#    phantomver = NULL,
#    verbose = TRUE,
#    port = 4169L,
#    check = FALSE
#)
# Close any existing connection
tryCatch(client$close(), error = function(e) {})
# Create a fresh connection
client <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox"
)
client <- selenium_server$client
# Close any existing connection
tryCatch(client$close(), error = function(e) {})
# Create a fresh connection
client <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox"
)
client$navigate("https://www.investing.com/economic-calendar/")
library(rvest)
library(readr)
library(RSelenium)
#library(netstat)
library(tidyverse)
library(lubridate)
library(zoo)
library(data.table)
#date to selects
startDate <- "09/02/2024"
endDate <- "11/02/2025"
#Category to select
category <- "#category_employment"
tryCatch(client$close(), error = function(e) {})
# Create a fresh connection
client <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox"
)
# launces a new Firefox window
client$open()
# install.packages(c("RSelenium", "netstat"))
library(rvest)
library(readr)
library(RSelenium)
library(netstat)
library(tidyverse)
library(lubridate)
library(zoo)
library(data.table)
URL_example <- "https://edikte.justiz.gv.at/edikte/id/idedi8.nsf/suchedi?SearchView&subf=vid&SearchOrder=4&SearchMax=4999&retfields=~SDatArt1=DATAF~SDatWert3=01.09.2025~SDatWert4=30.09.2025~SDatWert1=~SDatWert2=&ftquery=&query=_%26__01.09.2025_DATAF_30.09.2025_"
page_example <- read_html(URL_example)
example_texts <- page_example |>
html_elements(".rowlink") |> # here we select by class rowlink
html_elements("a") |> # here we select by tag a
html_text() |> # here we extract the tet inside the tag
as.data.frame() |>
rename("example_texts" = 1)
example_by_id <- page_example |>
html_elements("#ergebnisliste") |>
html_elements("a") |>
html_text() |>
as.data.frame()
example_table <- page_example |>
html_element("table") |> # notice that "element" is singular
html_table()
example_links <- page_example |>
html_elements(".rowlink") |>
html_elements("a") |>
html_attr("href") %>% # instead of the text, here we extract the attribute "href"
# .[str_detect(., 'OpenDocument')] |>
as.data.frame() |>
drop_na()
example_data <- cbind(example_texts, example_links)
names(example_data) <- c("example_texts", "example_links")
example_data <- example_data |>
filter(substr(example_texts, 1, 2) %in% c("LG", "BG", "HG")) |>
mutate(example_links = paste0(
"https://edikte.justiz.gv.at/edikte/id/idedi8.nsf/",
example_links
))
date.end.month <- seq(
as.Date("2007-02-01"),
length = 12,
by = "months"
) - 1
date.begin.month <- seq(
as.Date("2007-01-01"),
length = 12,
by = "months"
)
date.end.month <- format(date.end.month, "%d.%m.%Y")
date.proper <- format(date.begin.month, "%Y-%m-%d")
date.begin.month <- format(date.begin.month, "%d.%m.%Y")
dates <- as.data.frame(cbind(
date.begin.month,
date.end.month,
date.proper
))
URL_base <- "https://edikte.justiz.gv.at/edikte/id/idedi8.nsf/suchedi?"
data_cases <- data.frame(
case_nr = character(),
case_link = character(),
case_address = character(),
month = character()
)
for (i in 1:nrow(dates)) {
temp <- NULL
URL_ext <- paste0(
"SearchView&subf=vid&SearchOrder=4&SearchMax=4999&retfields=~SDatArt1=~SDatWert3=~SDatWert4=~SDatWert1=",
dates[i, 1],
"~SDatWert2=",
dates[i, 2],
"~BMAZ=2&ftquery=&query=_%26__",
dates[i, 1],
"_DATBM_",
dates[i, 2],
"_"
)
URL <- paste0(URL_base, URL_ext)
pg <- read_html(URL)
case_nr <- pg |>
html_elements(".rowlink") |>
html_elements("a") |>
html_text() |>
as.data.frame() |>
rename("case_nr" = 1)
case_link <- pg |>
html_elements(".rowlink") |>
html_elements("a") |>
html_attr("href") |>
as.data.frame() |>
rename("case_link" = 1)
case_address <- pg |>
html_element("table") |>
html_table() |>
rename(case_debtor = 3) |>
mutate(case_address = str_extract(case_debtor, "\\d{4}")) |>
select(case_address)
temp <- cbind(case_nr, case_link, case_address) |>
mutate(case_link = paste0("https://edikte.justiz.gv.at/edikte/id/idedi8.nsf/", case_link)) |>
mutate(month = dates[i, 3])
data_cases <- data_cases |> add_row(temp)
if (i %% 1 == 0) {
print(paste0("Total: ", nrow(dates), ", Current: ", i))
}
}
data_cases <- data_cases |>
arrange(month) |>
filter(!duplicated(case_nr))
write_csv(data_cases, "data/cases.csv")
example_info <- read_html(example_data$example_links[2]) %>%
html_elements("dl , div.zeilehead") %>%
html_text() %>%
as.data.frame() %>%
mutate(Sub = sapply(str_split(., ":"), "[[", 1)) %>%
mutate(Info = gsub("^.*?:", "", .)) %>%
select(-.)
example_type <- read_html(example_data$example_links[1]) |>
html_elements("#Verfahren") |>
html_text()
## get all the infos
data_info <- data.frame(
info = character(),
text = character(),
type = character(),
case_nr = character(),
case_link = character(),
case_address = character(),
month = character()
)
for (i in 1:nrow(data_cases)) {
temp <- NULL
temp <- read_html(data_cases$case_link[i]) %>%
html_elements("dl , div.zeilehead") %>%
html_text() %>%
as.data.frame() %>%
mutate(info = sapply(str_split(., ":"), "[[", 1)) %>%
mutate(text = gsub("^.*?:", "", .)) %>%
select(-.)
type <- read_html(data_cases$case_link[i]) |>
html_elements("#Verfahren") |>
html_text()
temp$type <- type[length(type)]
temp$case_nr <- data_cases$case_nr[i]
temp$case_link <- data_cases$case_link[i]
temp$case_address <- data_cases$case_address[i]
temp$month <- data_cases$month[i]
data_info <- data_info |> add_row(temp)
if (i %% 100 == 0) { # every 100 observation it gives an update on how far the code is
print(paste0("Total: ", nrow(data_cases), ", Current: ", i))
}
}
### dont run this part!! It will chrash
data_decisions <- data_info %>%
mutate(
court = sapply(str_split(case_nr, ", "), "[[", 1),
court = substr(court, 4, nchar(court)),
year = paste0(substr(month, 1, 4), "-01-01")
) %>%
mutate(
notice = ifelse(startsWith(info, "Bekannt gemacht") | startsWith(info, "In Ediktsdatei Ã¼bernommen am"), info, NA),
decision = ifelse(startsWith(info, "Beschluss vom"), info, NA)
) %>%
group_by(case_nr) %>%
mutate(
decision = ifelse(row_number() == 1, notice, decision),
decision = na.locf(decision),
notice = na.locf(notice)
) %>%
filter(startsWith(info, "Beschluss vom") == F & startsWith(info, "Bekannt gemacht") == F) %>%
ungroup()
data_wide <- data_decisions %>%
data.table() %>%
.[, order := .GRP, by = .(case_nr, decision)] %>%
data.table::dcast(
case_nr + case_link + court + order + type + month + year + notice + decision ~ info,
value.var = "text",
fun.aggregate = function(x) paste(x, collapse = " "),
fill = NA
) %>%
arrange(order) %>%
group_by(case_nr) %>%
mutate(
decision_nr = seq_along(decision) - 1,
decision_count = max(decision_nr),
notice_date = gsub("Bekannt gemacht am ", "", notice),
decision_date = gsub("Bekannt gemacht am ", "", decision),
decision_date = gsub("Beschluss vom ", "", decision_date),
notice_year = as.numeric(stringr::str_extract(notice_date, "\\d{4}")),
birth_debtor = str_extract(Schuldner, "[0-9/]{2}.[0-9/]{2}.[0-9/]{4}"),
birth_debtor = substr(birth_debtor, 1, 10),
birth_debtor = ifelse(grepl("/", birth_debtor) == T, NA, birth_debtor),
name_debtor = sapply(str_split(Schuldner, "Vorname"), "[[", 1)
) %>%
select(-order) %>%
group_by(case_nr) %>%
mutate(
name_debtor = na.locf(name_debtor, na.rm = T),
birth_debtor = na.locf(birth_debtor, na.rm = F, fromLast = T)
) %>%
ungroup()
### =====original code===== ###
#selenium_server <- rsDriver( # firefox is used since it is more stable
#    browser = "firefox",
#    chromever = NULL, # specify the chrome version
#    verbose = FALSE,
#    port = 3333L
#)
#client <- selenium_server$client
### =====original code===== ###
### ====adjusted part from mail==== ###
# Close any existing connection
tryCatch(client$close(), error = function(e) {})
# Create a fresh connection
client <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox"
)
client$open()
### ====adjusted part from mail==== ###
# Close any existing connection
tryCatch(client$close(), error = function(e) {})
URL_example <- "https://edikte.justiz.gv.at/edikte/id/idedi8.nsf/suchedi?SearchView&subf=vid&SearchOrder=4&SearchMax=4999&retfields=~SDatArt1=DATAF~SDatWert3=01.09.2025~SDatWert4=30.09.2025~SDatWert1=~SDatWert2=&ftquery=&query=_%26__01.09.2025_DATAF_30.09.2025_"
